<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA NTI | Conect Inova√ß√£o</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00adef;
            --neon: #00ff9d;
            --bg-space: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072');
            --glass: rgba(15, 23, 42, 0.85);
        }

        * { box-sizing: border-box; transition: all 0.3s ease; }
        body { 
            margin: 0; font-family: 'Poppins', sans-serif; 
            background: #020617 var(--bg-space) no-repeat center center fixed;
            background-size: cover; color: #fff; height: 100vh; overflow: hidden;
        }

        .hidden { display: none !important; }

        /* --- TELA DE LOGIN ESTILIZADA --- */
        #view-login {
            position: fixed; z-index: 1000; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
        }
        .login-card {
            background: var(--glass); padding: 40px; border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.1); text-align: center; width: 350px;
            box-shadow: 0 0 50px rgba(0, 173, 239, 0.2);
        }

        /* --- ESTRUTURA PRINCIPAL --- */
        .app-container { display: flex; height: 100vh; }

        /* SIDEBAR COM IMAGEM DA TERRA */
        aside { 
            width: 280px; background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), var(--bg-space);
            background-size: cover; background-position: left;
            border-right: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; padding: 40px 20px;
            backdrop-filter: blur(5px);
        }

        .logo-nti { margin-bottom: 40px; }
        .logo-nti h1 { 
            font-family: 'Orbitron', sans-serif; font-size: 20px; color: var(--primary); 
            margin: 0; text-shadow: 0 0 15px var(--primary); letter-spacing: 2px;
        }
        .logo-nti p { font-size: 10px; text-transform: uppercase; letter-spacing: 4px; opacity: 0.7; margin: 5px 0; }

        .nav-link {
            padding: 15px; margin-bottom: 12px; border-radius: 15px; background: rgba(255,255,255,0.05);
            border: 1px solid transparent; color: #fff; cursor: pointer; display: flex; align-items: center; gap: 15px;
            text-decoration: none; font-weight: 500;
        }
        .nav-link:hover, .nav-link.active { background: var(--primary); border-color: var(--neon); transform: translateX(5px); }

        /* √ÅREA DE CONTE√öDO */
        main { flex: 1; padding: 40px; overflow-y: auto; background: rgba(2, 6, 23, 0.5); }
        .section-header { margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; }

        /* --- DASHBOARD INICIAL (CARDS) --- */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .card-mod {
            background: var(--glass); border: 1px solid rgba(255,255,255,0.1);
            padding: 30px; border-radius: 25px; text-align: center; cursor: pointer;
        }
        .card-mod:hover { border-color: var(--primary); background: rgba(0, 173, 239, 0.1); transform: translateY(-5px); }
        .card-mod i { font-size: 40px; display: block; margin-bottom: 15px; }

        /* FORMUL√ÅRIOS E LISTAS */
        input, textarea, select {
            width: 100%; padding: 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1);
            background: rgba(0,0,0,0.3); color: white; margin-bottom: 15px; outline: none;
        }
        .btn-main {
            width: 100%; padding: 15px; border-radius: 10px; border: none; background: var(--primary);
            color: white; font-weight: bold; cursor: pointer; text-transform: uppercase;
        }

        .footer-fixed { position: fixed; bottom: 15px; right: 20px; font-size: 11px; color: rgba(255,255,255,0.3); }
    </style>
</head>
<body>

    <div id="view-login">
        <div class="login-card">
            <div class="logo-nti">
                <h1>SISTEMA NTI</h1>
                <p>Portal do Professor</p>
            </div>
            <input type="number" id="in-pront" placeholder="Seu Prontu√°rio" oninput="app.checar(this.value)">
            <div id="cad-extra" class="hidden">
                <input type="text" id="in-nome" placeholder="Nome Completo">
            </div>
            <input type="password" id="in-pass" placeholder="Senha">
            <button class="btn-main" onclick="app.logar()">Acessar Esta√ß√£o</button>
        </div>
    </div>

    <div class="app-container">
        <aside>
            <div class="logo-nti">
                <h1>SISTEMA NTI</h1>
                <p>Conect Inova√ß√£o</p>
            </div>
            <nav>
                <div class="nav-link active" onclick="app.tab('home', this)">üè† In√≠cio</div>
                <div class="nav-link" onclick="app.tab('reserva', this)">üìÖ Reservas</div>
                <div class="nav-link" onclick="app.tab('ti', this)">üõ†Ô∏è Suporte TI</div>
                <div class="nav-link" onclick="app.tab('chat', this)">üí¨ Chat Geral</div>
            </nav>
            <div style="margin-top:auto;">
                <button class="btn-main" style="background:rgba(231, 76, 60, 0.2); border:1px solid #e74c3c;" onclick="location.reload()">Sair</button>
            </div>
        </aside>

        <main>
            <section id="sec-home">
                <div class="section-header"><h2>Bem-vindo ao Painel de Controle</h2></div>
                <div class="dashboard-grid">
                    <div class="card-mod" onclick="app.tab('reserva')"><i>üì∫</i><b>RESERVAR EQUIPAMENTOS</b><p style="font-size:11px; opacity:0.6;">TVs, Chromebooks e Sala</p></div>
                    <div class="card-mod" onclick="app.tab('ti')"><i>üÜò</i><b>ABRIR CHAMADO TI</b><p style="font-size:11px; opacity:0.6;">Relatar problemas t√©cnicos</p></div>
                    <div class="card-mod" onclick="app.tab('home')"><i>üïí</i><b>VER CRONOGRAMA</b><p style="font-size:11px; opacity:0.6;">Status em tempo real</p></div>
                </div>
                
                <h3 style="margin-top:40px; color:var(--neon);">üïí Status de Hoje</h3>
                <div id="feed-live" style="background:var(--glass); border-radius:20px; padding:20px; font-size:14px;"></div>
            </section>

            <section id="sec-reserva" class="hidden">
                <div class="section-header"><h2>Reserva de Equipamentos</h2></div>
                <div class="dashboard-grid">
                    <div class="card-mod"><b>TV SMART 01</b><button class="btn-main" onclick="app.reservar('TV 01')">Agendar</button></div>
                    <div class="card-mod"><b>TV SMART 02</b><button class="btn-main" onclick="app.reservar('TV 02')">Agendar</button></div>
                    <div class="card-mod"><b>CARRINHO CHROME</b><button class="btn-main" onclick="app.reservar('Chromebooks')">Agendar</button></div>
                    <div class="card-mod"><b>SALA DE INFO</b><button class="btn-main" onclick="app.reservar('Sala Info')">Agendar</button></div>
                </div>
            </section>

            <section id="sec-ti" class="hidden">
                <div class="section-header"><h2>Suporte T√©cnico NTI</h2></div>
                <div class="login-card" style="width:100%; text-align:left;">
                    <label>Gravidade do Problema:</label>
                    <select id="gravidade">
                        <option value="Baixa">üü¢ Baixa - D√∫vidas ou Ajustes</option>
                        <option value="M√©dia">üü° M√©dia - Lentid√£o ou Erros</option>
                        <option value="Alta">üî¥ Alta - Sistema Parado / Urgente</option>
                    </select>
                    <textarea id="relato" rows="5" placeholder="O que aconteceu?"></textarea>
                    <button class="btn-main" style="background:#e74c3c;" onclick="app.enviarChamado()">Enviar para Kelvin (TI)</button>
                </div>
            </section>

            <section id="sec-chat" class="hidden">
                <div class="section-header"><h2>Chat Conect NTI</h2></div>
                <div id="chat-box" style="height:350px; background:var(--glass); border-radius:20px; padding:20px; overflow-y:auto; margin-bottom:20px;"></div>
                <div style="display:flex; gap:10px;">
                    <input type="text" id="chat-in" placeholder="Digite sua mensagem...">
                    <button class="btn-main" style="width:100px; margin:0;" onclick="app.enviarChat()">Enviar</button>
                </div>
            </section>
        </main>
    </div>

    <div class="footer-fixed">Desenvolvido por <b>Kelvin</b> | Conect NTI</div>

<script>
    const firebaseConfig = { databaseURL: "https://escala-chacara-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const app = {
        user: null, existe: false,

        async checar(p) {
            if(p.length < 3) return;
            const snap = await db.ref(`usuarios/professores/${p}`).once('value');
            this.existe = snap.exists();
            document.getElementById('cad-extra').classList.toggle('hidden', this.existe);
        },

        async logar() {
            const p = document.getElementById('in-pront').value;
            const s = document.getElementById('in-pass').value;
            if(this.existe) {
                const snap = await db.ref(`usuarios/professores/${p}`).once('value');
                if(snap.val().pass === s) this.init(snap.val()); else alert("Senha incorreta");
            } else {
                const n = document.getElementById('in-nome').value;
                if(!n || !s) return alert("Complete os dados");
                const u = { nome: n, pront: p, pass: s };
                await db.ref(`usuarios/professores/${p}`).set(u);
                this.init(u);
            }
        },

        init(user) {
            this.user = user;
            document.getElementById('view-login').classList.add('hidden');
            this.ouvir();
        },

        tab(id, btn) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById('sec-'+id).classList.remove('hidden');
            if(btn) {
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                btn.classList.add('active');
            }
        },

        reservar(item) {
            const aula = prompt(`Qual aula/hor√°rio para ${item}?`);
            if(aula) db.ref('reservas').push({ prof: this.user.nome, item, aula });
        },

        enviarChamado() {
            const g = document.getElementById('gravidade').value;
            const r = document.getElementById('relato').value;
            if(r) {
                db.ref('chamados').push({ prof: this.user.nome, g, r });
                alert("Chamado enviado ao Kelvin!");
                this.tab('home');
            }
        },

        enviarChat() {
            const m = document.getElementById('chat-in').value;
            if(m) { db.ref('chat').push({ nome: this.user.nome, m }); document.getElementById('chat-in').value = ""; }
        },

        ouvir() {
            db.ref('reservas').on('value', snap => {
                const f = document.getElementById('feed-live'); f.innerHTML = "";
                snap.forEach(d => { f.innerHTML += `<div>‚óè <b>${d.val().prof}</b> reservou <b>${d.val().item}</b> (${d.val().aula})</div>`; });
            });
            db.ref('chat').on('value', snap => {
                const b = document.getElementById('chat-box'); b.innerHTML = "";
                snap.forEach(d => { b.innerHTML += `<div style="margin-bottom:10px;"><b>${d.val().nome}:</b> ${d.val().m}</div>`; });
                b.scrollTop = b.scrollHeight;
            });
        }
    };
</script>
</body>
</html>
