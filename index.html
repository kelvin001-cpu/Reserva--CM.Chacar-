<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA NTI - Portal do Professor</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00adef;
            --bg: #020617;
            --card: rgba(15, 23, 42, 0.9);
            --border: rgba(255, 255, 255, 0.1);
            --sidebar-w: 260px;
        }

        * { box-sizing: border-box; transition: all 0.3s ease; }
        body { 
            margin: 0; font-family: 'Inter', sans-serif; 
            background: var(--bg) url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072') no-repeat center center fixed;
            background-size: cover; color: #f8fafc; height: 100vh; overflow: hidden;
        }

        /* --- LAYOUT ESTRUTURADO --- */
        .app-container { display: flex; height: 100vh; width: 100%; }

        /* MENU LATERAL (SIDEBAR) */
        aside { 
            width: var(--sidebar-w); background: rgba(0, 0, 0, 0.4); 
            backdrop-filter: blur(20px); border-right: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 30px 20px;
        }

        .logo-area { margin-bottom: 50px; border-left: 3px solid var(--primary); padding-left: 15px; }
        .logo-area h1 { font-size: 18px; letter-spacing: 2px; margin: 0; color: var(--primary); }
        .logo-area span { font-size: 10px; text-transform: uppercase; opacity: 0.6; }

        nav { flex-grow: 1; }
        .nav-btn { 
            width: 100%; padding: 15px; margin-bottom: 10px; border-radius: 12px;
            background: transparent; border: 1px solid transparent; color: #94a3b8;
            text-align: left; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 12px;
        }
        .nav-btn:hover, .nav-btn.active { 
            background: rgba(0, 173, 239, 0.1); border-color: var(--primary); color: white; 
        }

        /* CONTE√öDO PRINCIPAL */
        main { flex-grow: 1; padding: 40px; overflow-y: auto; display: flex; justify-content: center; }
        .content-card { 
            width: 100%; max-width: 900px; background: var(--card); 
            border-radius: 24px; border: 1px solid var(--border); padding: 40px;
            backdrop-filter: blur(10px); height: fit-content;
        }

        /* --- COMPONENTES --- */
        .grid-items { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .item-card { 
            background: rgba(255,255,255,0.03); border: 1px solid var(--border); 
            padding: 20px; border-radius: 16px; text-align: center;
        }
        .btn-action { 
            background: var(--primary); color: white; border: none; padding: 12px 25px; 
            border-radius: 8px; font-weight: 700; cursor: pointer; margin-top: 15px; width: 100%;
        }

        /* CRONOGRAMA & CHAT */
        .list-box { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px; margin-top: 20px; max-height: 300px; overflow-y: auto; }
        .list-item { padding: 10px; border-bottom: 1px solid var(--border); font-size: 14px; }

        /* UTILIT√ÅRIOS */
        .hidden { display: none !important; }
        .footer-credit { position: absolute; bottom: 20px; left: 20px; font-size: 10px; opacity: 0.5; }
        .grav-btns { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .grav-btns button { padding: 10px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

    <div id="view-login" style="position:fixed; z-index:1000; width:100%; height:100%; background:var(--bg); display:flex; align-items:center; justify-content:center;">
        <div class="content-card" style="max-width:400px; text-align:center;">
            <h2>Portal Professor</h2>
            <input type="number" id="in-pront" placeholder="Prontu√°rio" style="width:100%; padding:15px; border-radius:10px; border:1px solid #334155; background:#0f172a; color:white; margin-bottom:10px;" oninput="app.checar(this.value)">
            <div id="cad-extra" class="hidden">
                <input type="text" id="in-nome" placeholder="Seu Nome Completo" style="width:100%; padding:15px; border-radius:10px; border:1px solid #334155; background:#0f172a; color:white; margin-bottom:10px;">
            </div>
            <input type="password" id="in-pass" placeholder="Senha" style="width:100%; padding:15px; border-radius:10px; border:1px solid #334155; background:#0f172a; color:white;">
            <button class="btn-action" onclick="app.logar()">ENTRAR NO SISTEMA</button>
        </div>
    </div>

    <div class="app-container">
        <aside>
            <div class="logo-area">
                <h1>SISTEMA NTI</h1>
                <span>Conect Inova√ß√£o</span>
            </div>
            <nav>
                <button class="nav-btn active" onclick="app.tab('reserva', this)">üìÖ Reservas</button>
                <button class="nav-btn" onclick="app.tab('ti', this)">üõ†Ô∏è Suporte TI</button>
                <button class="nav-btn" onclick="app.tab('live', this)">üïí Cronograma</button>
                <button class="nav-btn" onclick="app.tab('chat', this)">üí¨ Chat Geral</button>
            </nav>
            <div style="margin-top:auto;">
                <button class="nav-btn" style="color:#ef4444;" onclick="location.reload()">Sair da Conta</button>
            </div>
        </aside>

        <main>
            <section id="sec-reserva" class="content-card">
                <h2 style="margin:0;">Reserva de Equipamentos</h2>
                <p style="opacity:0.6; font-size:14px;">Selecione o recurso para sua aula.</p>
                <div class="grid-items">
                    <div class="item-card"><b>üì∫ TV Smart 01</b><button class="btn-action" onclick="app.reservar('TV 01')">Reservar</button></div>
                    <div class="item-card"><b>üì∫ TV Smart 02</b><button class="btn-action" onclick="app.reservar('TV 02')">Reservar</button></div>
                    <div class="item-card"><b>üì∫ TV Smart 03</b><button class="btn-action" onclick="app.reservar('TV 03')">Reservar</button></div>
                    <div class="item-card"><b>üíª Chromebooks</b><button class="btn-action" onclick="app.reservar('Carrinho CB')">Reservar</button></div>
                    <div class="item-card" style="grid-column: span 2;"><b>üñ•Ô∏è Sala de Inform√°tica</b><button class="btn-action" onclick="app.reservar('Sala Info')">Reservar Sala Completa</button></div>
                </div>
            </section>

            <section id="sec-ti" class="content-card hidden">
                <h2>Suporte T√©cnico NTI</h2>
                <p style="opacity:0.6; font-size:14px;">Abra um chamado direto para o Kelvin (TI).</p>
                <div class="grav-btns">
                    <button style="background:#22c55e; color:white;" onclick="app.grav='Baixa'">BAIXA</button>
                    <button style="background:#eab308; color:white;" onclick="app.grav='M√©dia'">M√âDIA</button>
                    <button style="background:#ef4444; color:white;" onclick="app.grav='ALTA'">ALTA</button>
                </div>
                <textarea id="relato" rows="6" placeholder="O que aconteceu? Descreva com detalhes..." style="width:100%; border-radius:12px; background:rgba(0,0,0,0.3); color:white; padding:15px; border:1px solid var(--border);"></textarea>
                <button class="btn-action" style="background:#ef4444;" onclick="app.enviarChamado()">ENVIAR CHAMADO URGENTE</button>
            </section>

            <section id="sec-live" class="content-card hidden">
                <h2>Cronograma em Tempo Real</h2>
                <div class="list-box" id="feed-live"></div>
            </section>

            <section id="sec-chat" class="content-card hidden">
                <h2>Chat Conect NTI</h2>
                <div class="list-box" id="chat-box" style="height:350px;"></div>
                <div style="display:flex; gap:10px; margin-top:15px;">
                    <input type="text" id="chat-in" placeholder="Escreva aqui..." style="flex-grow:1; padding:12px; border-radius:8px; border:none; background:#0f172a; color:white;">
                    <button class="btn-action" style="margin:0; width:100px;" onclick="app.enviarChat()">ENVIAR</button>
                </div>
            </section>
        </main>
    </div>

    <div class="footer-credit">Feito pelo estagi√°rio <b>Kelvin</b> | Programa <b>Conect NTI</b></div>

<script>
    const firebaseConfig = { databaseURL: "https://escala-chacara-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const app = {
        user: null, existe: false, grav: 'Baixa',

        async checar(p) {
            if(p.length < 3) return;
            const snap = await db.ref(`usuarios/professores/${p}`).once('value');
            this.existe = snap.exists();
            document.getElementById('cad-extra').classList.toggle('hidden', this.existe);
        },

        async logar() {
            const p = document.getElementById('in-pront').value;
            const s = document.getElementById('in-pass').value;
            if(this.existe) {
                const snap = await db.ref(`usuarios/professores/${p}`).once('value');
                if(snap.val().pass === s) this.iniciar(snap.val()); else alert("Senha incorreta");
            } else {
                const n = document.getElementById('in-nome').value;
                if(!n || !s) return alert("Complete os dados");
                const u = { nome: n, pront: p, pass: s };
                await db.ref(`usuarios/professores/${p}`).set(u);
                this.iniciar(u);
            }
        },

        iniciar(user) {
            this.user = user;
            document.getElementById('view-login').classList.add('hidden');
            this.ouvirDados();
        },

        tab(id, btn) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById('sec-'+id).classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        },

        reservar(item) {
            const aula = prompt(`Qual aula para ${item}?`);
            if(aula) db.ref('reservas').push({ prof: this.user.nome, item, aula });
        },

        enviarChamado() {
            const r = document.getElementById('relato').value;
            if(r) {
                db.ref('chamados').push({ prof: this.user.nome, g: this.grav, r });
                alert("Chamado Aberto!");
                document.getElementById('relato').value = "";
            }
        },

        enviarChat() {
            const m = document.getElementById('chat-in').value;
            if(m) { db.ref('chat').push({ nome: this.user.nome, m }); document.getElementById('chat-in').value = ""; }
        },

        ouvirDados() {
            db.ref('reservas').on('value', snap => {
                const f = document.getElementById('feed-live'); f.innerHTML = "";
                snap.forEach(d => { f.innerHTML += `<div class="list-item"><b>${d.val().prof}</b> reservou <b>${d.val().item}</b> (${d.val().aula})</div>`; });
            });
            db.ref('chat').on('value', snap => {
                const b = document.getElementById('chat-box'); b.innerHTML = "";
                snap.forEach(d => { b.innerHTML += `<div class="list-item"><b>${d.val().nome}:</b> ${d.val().m}</div>`; });
                b.scrollTop = b.scrollHeight;
            });
        }
    };
</script>
</body>
</html>
