<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA CORE - CM CH√ÅCARA DAS GAR√áAS</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --sp-blue: #004a99; --neon-cyan: #00f3ff; --neon-green: #00ff9d;
            --neon-red: #ff0055; --neon-yellow: #ffee00; --glass-bg: rgba(0, 20, 40, 0.85);
        }

        body { 
            margin: 0; font-family: 'Rajdhani', sans-serif; background: #000814;
            color: white; min-height: 100vh; overflow-x: hidden;
            display: flex; align-items: center; justify-content: center;
        }

        /* Fundo Tecnol√≥gico Animado */
        .tech-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #001d3d 0%, #000814 100%);
            z-index: -1;
        }
        .tech-bg::before {
            content: ""; position: absolute; width: 200%; height: 200%;
            background-image: linear-gradient(rgba(0, 243, 255, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
            background-size: 40px 40px; transform: rotate(15deg); top: -50%; left: -50%; animation: move 60s linear infinite;
        }
        @keyframes move { from { transform: rotate(15deg) translateY(0); } to { transform: rotate(15deg) translateY(1000px); } }

        header {
            position: fixed; top: 0; width: 100%; background: white; padding: 10px 0;
            text-align: center; border-bottom: 4px solid var(--neon-cyan); box-shadow: 0 0 20px var(--neon-cyan);
        }
        .logo-text { font-family: 'Orbitron', sans-serif; color: var(--sp-blue); font-size: 18px; margin: 0; letter-spacing: 2px; }

        .container { width: 90%; max-width: 450px; margin-top: 80px; }

        /* Card Hologr√°fico */
        .cyber-card { 
            background: var(--glass-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 2px solid var(--neon-cyan); border-radius: 0 30px 0 30px; padding: 30px;
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.2); position: relative; transition: 0.5s;
        }

        h2 { font-family: 'Orbitron', sans-serif; font-size: 16px; text-transform: uppercase; color: var(--neon-cyan); margin-bottom: 25px; text-shadow: 0 0 10px var(--neon-cyan); text-align: center; }

        /* Menu Interativo Foda */
        .main-menu { display: grid; grid-template-columns: 1fr; gap: 20px; }
        .menu-opt {
            background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(0, 243, 255, 0.3);
            padding: 25px; border-radius: 15px; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; justify-content: space-between;
            position: relative; overflow: hidden;
        }
        .menu-opt::before { content: ""; position: absolute; left: -100%; top: 0; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(0, 243, 255, 0.2), transparent); transition: 0.5s; }
        .menu-opt:hover { border-color: var(--neon-cyan); transform: scale(1.02); box-shadow: 0 0 20px rgba(0, 243, 255, 0.3); }
        .menu-opt:hover::before { left: 100%; }
        .menu-opt span { font-family: 'Orbitron'; font-size: 14px; font-weight: bold; }
        .menu-opt i { font-size: 24px; }

        /* Inputs e Formul√°rios */
        .field { margin-bottom: 15px; text-align: left; }
        label { display: block; font-size: 10px; color: var(--neon-cyan); margin: 0 0 5px 5px; text-transform: uppercase; letter-spacing: 1px; }
        input, select, textarea {
            width: 100%; background: rgba(0, 0, 0, 0.4); border: 1px solid var(--neon-cyan);
            padding: 12px; color: white; font-family: 'Rajdhani'; font-size: 16px; border-radius: 8px; outline: none;
        }
        input:focus { box-shadow: 0 0 10px var(--neon-cyan); }

        /* Gravidade Estilo Cockpit */
        .gravity-panel { display: flex; gap: 10px; margin: 20px 0; }
        .grav-btn {
            flex: 1; padding: 15px 5px; border: 2px solid #333; border-radius: 10px;
            cursor: pointer; font-family: 'Orbitron'; font-size: 9px; font-weight: bold;
            text-align: center; transition: 0.3s; opacity: 0.5;
        }
        .grav-btn.v { border-color: var(--neon-green); color: var(--neon-green); }
        .grav-btn.a { border-color: var(--neon-yellow); color: var(--neon-yellow); }
        .grav-btn.r { border-color: var(--neon-red); color: var(--neon-red); }
        .grav-btn.active { opacity: 1; box-shadow: inset 0 0 15px currentColor, 0 0 15px currentColor; background: rgba(255,255,255,0.05); }

        .btn-confirm {
            width: 100%; padding: 18px; background: transparent; border: 2px solid var(--neon-cyan);
            color: var(--neon-cyan); font-family: 'Orbitron'; cursor: pointer; border-radius: 10px;
            font-weight: bold; text-transform: uppercase; transition: 0.4s; margin-top: 10px;
        }
        .btn-confirm:hover { background: var(--neon-cyan); color: #000; box-shadow: 0 0 30px var(--neon-cyan); }

        .hidden { display: none; }
        .btn-reset { background: none; border: none; color: #555; font-size: 10px; margin-top: 25px; cursor: pointer; width: 100%; text-decoration: underline; }
    </style>
</head>
<body>

<div class="tech-bg"></div>

<header>
    <p class="logo-text">SANTANA DE PARNA√çBA</p>
    <div style="font-size: 10px; color: #666; font-weight: bold;">C.M. CH√ÅCARA DAS GAR√áAS ‚Ä¢ TECH PORTAL</div>
</header>

<div class="container">
    <div id="scr_login" class="cyber-card">
        <h2>System_Identity</h2>
        <div class="field">
            <label>Selecione seu Perfil</label>
            <select id="user_gen">
                <option value="Professor">‚ôÇ Professor</option>
                <option value="Professora">‚ôÄ Professora</option>
            </select>
        </div>
        <div class="field"><label>Nome_Completo</label><input type="text" id="user_name"></div>
        <div class="field"><label>Prontu√°rio_ID</label><input type="text" id="user_id"></div>
        <button class="btn-confirm" onclick="init()">INICIAR PROTOCOLO</button>
    </div>

    <div id="scr_menu" class="cyber-card hidden">
        <h2 id="welc">MENU_LINK</h2>
        <div class="main-menu">
            <div class="menu-opt" onclick="go('scr_reserva')">
                <span>01. RESERVAR ITEM</span>
                <i>üìÖ</i>
            </div>
            <div class="menu-opt" onclick="go('scr_ti')" style="border-color: var(--neon-green);">
                <span style="color: var(--neon-green);">02. SUPORTE TI (KELVIN)</span>
                <i>üõ†Ô∏è</i>
            </div>
        </div>
        <button class="btn-reset" onclick="localStorage.clear(); location.reload();">LOGOUT_USER</button>
    </div>

    <div id="scr_reserva" class="cyber-card hidden">
        <h2>Reserve_Log</h2>
        <div class="field">
            <label>Hardware</label>
            <select id="res_item"><option>üñ•Ô∏è SALA DE INFORM√ÅTICA</option><option>üíª CHROMEBOOKS</option><option>üì∫ TV DIGITAL</option></select>
        </div>
        <div class="field"><label>Data_Retirada</label><input type="datetime-local" id="t1"></div>
        <div class="field"><label>Data_Devolu√ß√£o</label><input type="datetime-local" id="t2"></div>
        <button class="btn-confirm" onclick="doRes()">CONFIRMAR RESERVA</button>
        <button class="btn-reset" onclick="go('scr_menu')">VOLTAR</button>
    </div>

    <div id="scr_ti" class="cyber-card hidden">
        <h2>Support_Request</h2>
        <p style="text-align:center; font-size:12px; color: var(--neon-green); margin-bottom: 20px;">"Ol√°, eu sou o Kelvin. Relate a falha do sistema."</p>
        
        <label>N√≠vel de Gravidade</label>
        <div class="gravity-panel">
            <div class="grav-btn v" id="gv" onclick="setG('Verde','gv')">TRANQUILO</div>
            <div class="grav-btn a" id="ga" onclick="setG('Amarelo','ga')">M√âDIO</div>
            <div class="grav-btn r" id="gr" onclick="setG('Vermelho','gr')">URGENTE</div>
        </div>

        <div class="field"><label>Localiza√ß√£o_Sala</label><input type="text" id="ti_sala" placeholder="Ex: Sala 05"></div>
        <div class="field"><label>Descri√ß√£o_Erro</label><textarea id="ti_msg" rows="3"></textarea></div>
        
        <button class="btn-confirm" onclick="doTI()" style="border-color: var(--neon-green); color: var(--neon-green);">ENVIAR CHAMADO</button>
        <button class="btn-reset" onclick="go('scr_menu')">VOLTAR</button>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBoGFDKz-nBwKvczGpxg-fHJYdVykcBUQ",
        authDomain: "escala-chacara.firebaseapp.com",
        databaseURL: "https://escala-chacara-default-rtdb.firebaseio.com",
        projectId: "escala-chacara",
        storageBucket: "escala-chacara.firebasestorage.app",
        messagingSenderId: "741259231706",
        appId: "1:741259231706:web:27e2b60be100e6a34180e3"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    let g_sel = "";
    let user = JSON.parse(localStorage.getItem('user_sp'));

    window.onload = () => { if(user) go('scr_menu'); };

    window.go = (id) => {
        document.querySelectorAll('.cyber-card').forEach(c => c.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
        if(id === 'scr_menu' && user) {
            document.getElementById('welc').innerText = user.name.split(' ')[0].toUpperCase() + "_PORTAL";
        }
    };

    window.init = () => {
        const n = document.getElementById('user_name').value;
        const p = document.getElementById('user_id').value;
        if(n && p) {
            user = { name: n, id: p, gen: document.getElementById('user_gen').value };
            localStorage.setItem('user_sp', JSON.stringify(user));
            go('scr_menu');
        }
    };

    window.setG = (val, id) => {
        g_sel = val;
        document.querySelectorAll('.grav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    };

    window.doRes = () => {
        const t1 = document.getElementById('t1').value, t2 = document.getElementById('t2').value;
        if(!t1 || !t2) return alert("Defina os hor√°rios!");
        set(push(ref(db, 'reservas')), { ...user, item: document.getElementById('res_item').value, start: t1, end: t2 })
        .then(() => { alert("Reserva Confirmada!"); go('scr_menu'); });
    };

    window.doTI = () => {
        const s = document.getElementById('ti_sala').value, m = document.getElementById('ti_msg').value;
        if(!g_sel || !s || !m) return alert("Preencha o suporte completo!");
        set(push(ref(db, 'chamados_ti')), { ...user, sala: s, msg: m, urgencia: g_sel, data: new Date().toLocaleString() })
        .then(() => { alert("Sinal enviado ao Kelvin!"); go('scr_menu'); });
    };
</script>
</body>
</html>
