<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NTi - Santana de Parna√≠ba</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --pref-azul: #003366;
            --pref-dourado: #c5a059;
            --bg-body: #f4f7f6;
            --card-white: #ffffff;
            --danger: #d9534f;
            --warning: #f0ad4e;
            --success: #5cb85c;
        }

        * { box-sizing: border-box; font-family: 'Montserrat', sans-serif; }
        
        body { 
            margin: 0; 
            background: var(--bg-body) url('https://www.santanadeparnaiba.sp.gov.br/assets/img/brasao_parnaiba_header.png') no-repeat center bottom fixed;
            background-size: 200px;
            min-height: 100vh;
            display: flex; align-items: center; justify-content: center;
        }

        .main-container {
            width: 95%; max-width: 600px;
            background: var(--card-white);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-top: 8px solid var(--pref-azul);
            padding: 30px;
            margin: 20px;
        }

        /* Cabe√ßalho */
        header { text-align: center; margin-bottom: 30px; }
        header h1 { color: var(--pref-azul); font-size: 22px; margin: 5px 0; font-weight: 800; }
        header p { font-size: 12px; color: #666; text-transform: uppercase; letter-spacing: 1px; }

        /* Estilo de Formul√°rios */
        .form-group { margin-bottom: 15px; text-align: left; }
        label { display: block; font-weight: 700; font-size: 13px; color: var(--pref-azul); margin-bottom: 5px; }
        input, select, textarea {
            width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; outline: none;
        }
        input:focus { border-color: var(--pref-azul); }

        /* Bot√µes */
        .btn-primary { 
            width: 100%; padding: 15px; border: none; border-radius: 8px; background: var(--pref-azul);
            color: white; font-weight: 700; font-size: 15px; cursor: pointer; transition: 0.3s;
        }
        .btn-primary:hover { background: #002244; }
        
        .btn-nav {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            padding: 20px; border: 1px solid #eee; border-radius: 12px; background: #fff;
            cursor: pointer; font-weight: 700; color: var(--pref-azul); transition: 0.2s;
        }
        .btn-nav:hover { background: #f0f7ff; border-color: var(--pref-azul); }

        /* Menu Grid */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }

        /* Status Badges */
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 10px; color: white; font-weight: 700; }
        .bg-urgente { background: var(--danger); }
        .bg-normal { background: var(--pref-azul); }

        /* Cards do Cronograma */
        .cron-card {
            background: #f9f9f9; border-left: 5px solid var(--pref-azul);
            padding: 15px; border-radius: 8px; margin-bottom: 10px; text-align: left;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .hidden { display: none; }
        .tab-btn { padding: 10px; border: none; background: none; cursor: pointer; font-weight: 700; color: #999; }
        .tab-btn.active { color: var(--pref-azul); border-bottom: 2px solid var(--pref-azul); }
    </style>
</head>
<body>

    <div class="main-container">
        <header>
            <img src="https://www.santanadeparnaiba.sp.gov.br/assets/img/brasao_parnaiba_header.png" height="50" alt="Bras√£o">
            <h1>SISTEMA NTi</h1>
            <p>Prefeitura de Santana de Parna√≠ba</p>
        </header>

        <div id="scr-auth">
            <div style="display: flex; justify-content: space-around; margin-bottom: 20px;">
                <button class="tab-btn active" id="tab-login" onclick="app.toggleAuth('login')">ENTRAR</button>
                <button class="tab-btn" id="tab-cad" onclick="app.toggleAuth('cad')">CADASTRAR</button>
            </div>

            <div id="auth-fields">
                <div class="form-group" id="group-nome" style="display:none">
                    <label>Nome Completo</label>
                    <input type="text" id="user-nome" placeholder="Seu nome">
                </div>
                <div class="form-group">
                    <label>Prontu√°rio / RP</label>
                    <input type="text" id="user-rp" placeholder="00.000">
                </div>
                <div class="form-group" id="group-mat" style="display:none">
                    <label>Mat√©ria / Disciplina</label>
                    <input type="text" id="user-mat" placeholder="Sua disciplina">
                </div>
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" id="user-pass" placeholder="******">
                </div>
                <button class="btn-primary" id="btn-auth-action" onclick="app.authAction()">ENTRAR NO SISTEMA</button>
            </div>
        </div>

        <div id="scr-menu" class="hidden">
            <div style="text-align: left; border-bottom: 1px solid #eee; padding-bottom: 10px;">
                <span style="font-size: 12px; color: #666;">Bem-vindo(a),</span>
                <div id="prof-nome" style="font-weight: 800; color: var(--pref-azul);">NOME PROFESSOR</div>
            </div>

            <div class="menu-grid">
                <button class="btn-nav" onclick="app.nav('reserva')">üìÖ RESERVAS</button>
                <button class="btn-nav" onclick="app.nav('ti')">üõ†Ô∏è TI / SUPORTE</button>
                <button class="btn-nav" style="grid-column: span 2;" onclick="app.nav('cron')">üñ•Ô∏è CRONOGRAMA EM TEMPO REAL</button>
            </div>
            <button class="btn-primary" style="margin-top:20px; background:#666" onclick="location.reload()">SAIR</button>
        </div>

        <div id="scr-ti" class="hidden">
            <h3>Chamado T√©cnico</h3>
            <div class="form-group">
                <label>Gravidade do Problema</label>
                <select id="ti-grau">
                    <option value="Baixa">Baixa (D√∫vida / Ajuste)</option>
                    <option value="M√©dia">M√©dia (Equipamento Lento)</option>
                    <option value="Alta">Alta (Parada Total)</option>
                    <option value="Cr√≠tica">Cr√≠tica (Rede Fora / Laborat√≥rio parado)</option>
                </select>
            </div>
            <div class="form-group">
                <label>Descri√ß√£o</label>
                <textarea id="ti-desc" rows="3" placeholder="O que est√° acontecendo?"></textarea>
            </div>
            <button class="btn-primary" onclick="app.salvarTI()">ABRIR CHAMADO</button>
            <button class="tab-btn" style="margin-top:10px" onclick="app.nav('menu')">VOLTAR</button>
        </div>

        <div id="scr-reserva" class="hidden">
            <h3>Nova Reserva</h3>
            <div class="form-group">
                <label>Equipamento / Espa√ßo</label>
                <select id="res-eq">
                    <option>SALA DE INFORM√ÅTICA</option>
                    <option>CARRINHO CHROMEBOOKS</option>
                    <option>TV M√ìVEL 01</option>
                    <option>TV M√ìVEL 02</option>
                    <option>PROJETOR MULTIM√çDIA</option>
                </select>
            </div>
            <div class="form-group">
                <label>Data da Reserva</label>
                <input type="date" id="res-data">
            </div>
            <div class="form-group">
                <label>Hor√°rio (In√≠cio - Fim)</label>
                <div style="display:flex; gap:10px">
                    <input type="time" id="res-hora-ini">
                    <input type="time" id="res-hora-fim">
                </div>
            </div>
            <button class="btn-primary" onclick="app.salvarReserva()">RESERVAR AGORA</button>
            <button class="tab-btn" style="margin-top:10px" onclick="app.nav('menu')">VOLTAR</button>
        </div>

        <div id="scr-cron" class="hidden">
            <h3>Cronograma Ativo</h3>
            <div id="cron-lista" style="max-height: 400px; overflow-y: auto;"></div>
            <button class="tab-btn" style="margin-top:10px" onclick="app.nav('menu')">VOLTAR AO MENU</button>
        </div>

    </div>

    <script>
        const app = {
            mode: 'login',
            currentUser: null,

            toggleAuth(m) {
                this.mode = m;
                document.getElementById('tab-login').classList.toggle('active', m === 'login');
                document.getElementById('tab-cad').classList.toggle('active', m === 'cad');
                document.getElementById('group-nome').style.display = m === 'cad' ? 'block' : 'none';
                document.getElementById('group-mat').style.display = m === 'cad' ? 'block' : 'none';
                document.getElementById('btn-auth-action').innerText = m === 'login' ? 'ENTRAR NO SISTEMA' : 'CONCLUIR CADASTRO';
            },

            authAction() {
                const rp = document.getElementById('user-rp').value;
                const pass = document.getElementById('user-pass').value;
                let users = JSON.parse(localStorage.getItem('nti_users') || '[]');

                if(this.mode === 'cad') {
                    const nome = document.getElementById('user-nome').value;
                    const mat = document.getElementById('user-mat').value;
                    if(!nome || !rp || !pass) return alert("Preencha todos os campos!");
                    
                    users.push({nome, rp, mat, pass});
                    localStorage.setItem('nti_users', JSON.stringify(users));
                    alert("Cadastro realizado com sucesso! Fa√ßa login.");
                    this.toggleAuth('login');
                } else {
                    const user = users.find(u => u.rp === rp && u.pass === pass);
                    if(user) {
                        this.currentUser = user;
                        document.getElementById('prof-nome').innerText = user.nome.toUpperCase();
                        this.nav('menu');
                    } else {
                        alert("Usu√°rio ou senha incorretos!");
                    }
                }
            },

            nav(p) {
                document.querySelectorAll('[id^="scr-"]').forEach(s => s.classList.add('hidden'));
                document.getElementById('scr-' + p).classList.remove('hidden');
                if(p === 'cron') this.renderCron();
            },

            salvarTI() {
                const grau = document.getElementById('ti-grau').value;
                const desc = document.getElementById('ti-desc').value;
                if(!desc) return alert("Descreva o problema!");

                const chamado = {
                    tipo: 'CHAMADO TI',
                    prof: this.currentUser.nome,
                    materia: this.currentUser.mat,
                    detalhe: `GRAVIDADE: ${grau} - ${desc}`,
                    data: new Date().toLocaleDateString(),
                    hora: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                };
                this.dbSave(chamado);
            },

            salvarReserva() {
                const eq = document.getElementById('res-eq').value;
                const data = document.getElementById('res-data').value;
                const ini = document.getElementById('res-hora-ini').value;
                const fim = document.getElementById('res-hora-fim').value;

                if(!data || !ini || !fim) return alert("Preencha os hor√°rios!");

                const reserva = {
                    tipo: 'RESERVA',
                    prof: this.currentUser.nome,
                    materia: this.currentUser.mat,
                    detalhe: `${eq}`,
                    data: data.split('-').reverse().join('/'),
                    hora: `${ini} √†s ${fim}`
                };
                this.dbSave(reserva);
            },

            dbSave(obj) {
                let db = JSON.parse(localStorage.getItem('nti_db_parnaiba') || '[]');
                db.push(obj);
                localStorage.setItem('nti_db_parnaiba', JSON.stringify(db));
                alert("Registrado com sucesso!");
                this.nav('cron');
            },

            renderCron() {
                const container = document.getElementById('cron-lista');
                let db = JSON.parse(localStorage.getItem('nti_db_parnaiba') || '[]');
                
                if(db.length === 0) {
                    container.innerHTML = "<p style='text-align:center; color:#999'>Nenhuma atividade hoje.</p>";
                    return;
                }

                container.innerHTML = db.reverse().map((it, i) => `
                    <div class="cron-card" style="border-left-color: ${it.tipo === 'RESERVA' ? '#003366' : '#d9534f'}">
                        <div style="display:flex; justify-content:space-between; align-items:start">
                            <span class="badge ${it.tipo === 'RESERVA' ? 'bg-normal' : 'bg-urgente'}">${it.tipo}</span>
                            <small style="font-weight:700">${it.data} √†s ${it.hora}</small>
                        </div>
                        <div style="margin-top:10px">
                            <strong style="color:var(--pref-azul)">${it.detalhe}</strong><br>
                            <span style="font-size:12px"><b>Solicitante:</b> ${it.prof}</span><br>
                            <span style="font-size:11px; color:#666"><b>Departamento/Mat√©ria:</b> ${it.materia}</span>
                        </div>
                        <button onclick="app.remover(${i})" style="margin-top:10px; border:none; background:none; color:red; cursor:pointer; font-size:10px">[ EXCLUIR ]</button>
                    </div>
                `).join('');
            },

            remover(i) {
                let db = JSON.parse(localStorage.getItem('nti_db_parnaiba') || '[]').reverse();
                db.splice(i, 1);
                localStorage.setItem('nti_db_parnaiba', JSON.stringify(db.reverse()));
                this.renderCron();
            }
        };
    </script>
</body>
</html>
