<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NTi - Gest√£o de Ativos C.M. Ch√°cara Das Gar√ßas</title>
    <style>
        :root {
            --azul-gov: #002d5e;
            --azul-claro: #0056b3;
            --dourado: #c5a059;
            --branco: #ffffff;
            --glass: rgba(255, 255, 255, 0.9);
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            /* Fundo tecnol√≥gico lindo */
            background: linear-gradient(rgba(0, 45, 94, 0.8), rgba(0, 45, 94, 0.8)), 
                        url('https://images.unsplash.com/photo-1518770660439-4636190af475?ixlib=rb-1.2.1&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            color: #333;
            min-height: 100vh;
        }

        header {
            background: var(--azul-gov);
            color: white;
            padding: 15px 5%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 4px solid var(--dourado);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .brasao-img { height: 50px; filter: brightness(0) invert(1); }

        .container { max-width: 850px; margin: 40px auto; padding: 10px; }

        .panel {
            background: var(--glass);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 20px;
        }

        h2 { color: var(--azul-gov); text-align: center; text-transform: uppercase; letter-spacing: 1px; }

        .form-group { margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: var(--azul-gov); }
        
        input, select, textarea { 
            width: 100%; padding: 12px; border: 1px solid #ccc; 
            border-radius: 8px; font-size: 15px; background: white;
        }

        .btn {
            background: var(--azul-claro);
            color: white; border: none; padding: 15px;
            width: 100%; font-weight: bold; cursor: pointer;
            text-transform: uppercase; border-radius: 8px;
            transition: 0.3s; font-size: 16px;
        }
        .btn:hover { background: #003d7a; transform: scale(1.02); }

        .sala-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 8px; margin: 15px 0; }
        .sala-btn {
            background: white; border: 2px solid #ddd; padding: 10px; 
            border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.2s;
        }
        .sala-btn.active { background: var(--azul-gov); color: white; border-color: var(--dourado); }

        #timer-display { font-size: 70px; font-weight: bold; color: var(--azul-gov); margin: 20px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        
        .hidden { display: none !important; }
        .status-badge { background: #d9534f; color: white; padding: 5px 10px; border-radius: 20px; font-size: 12px; }

        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .menu-card {
            background: var(--glass); padding: 40px; border-radius: 15px;
            text-align: center; cursor: pointer; transition: 0.3s; border: 1px solid rgba(255,255,255,0.3);
        }
        .menu-card:hover { background: white; transform: translateY(-5px); }
    </style>
</head>
<body>

<header>
    <div style="display: flex; align-items: center; gap: 15px;">
        <img src="https://www.santanadeparnaiba.sp.gov.br/portal/img/brasao.png" class="brasao-img" alt="Bras√£o">
        <div>
            <h1 style="margin:0; font-size: 18px;">NTi - CH√ÅCARA DAS GAR√áAS</h1>
            <small>Sistema de Controle de Ativos</small>
        </div>
    </div>
    <div id="user-display" style="font-weight: bold;">Acesso Restrito</div>
</header>

<div class="container">

    <div id="scr-login" class="panel">
        <h2>Acesso do Professor</h2>
        <div class="form-group">
            <label>Usu√°rio</label>
            <input type="text" id="log-user" placeholder="E-mail ou RP">
        </div>
        <div class="form-group">
            <label>Senha</label>
            <input type="password" id="log-pass" placeholder="******">
        </div>
        <button class="btn" onclick="show('scr-perfil')">Entrar</button>
    </div>

    <div id="scr-perfil" class="panel hidden">
        <h2>Dados de Identifica√ß√£o</h2>
        <input type="text" id="prof-nome" placeholder="Seu nome completo" class="form-group">
        <div style="display: flex; gap: 10px;">
            <input type="text" id="prof-rp" placeholder="Prontu√°rio/RP" class="form-group">
            <input type="text" id="prof-mat" placeholder="Mat√©ria" class="form-group">
        </div>
        <button class="btn" onclick="salvarPerfil()">Confirmar Dados</button>
    </div>

    <div id="scr-menu" class="hidden">
        <div class="menu-grid">
            <div class="menu-card" onclick="show('scr-reserva')">
                <span style="font-size: 50px;">üìÖ</span><br><b>RESERVAR</b>
            </div>
            <div class="menu-card" onclick="show('scr-suporte')">
                <span style="font-size: 50px;">üõ†Ô∏è</span><br><b>SUPORTE TI</b>
            </div>
        </div>
    </div>

    <div id="scr-reserva" class="panel hidden">
        <h2>Agendar Equipamento</h2>
        
        <label>1. Selecione a Sala de Aula:</label>
        <div id="grid-salas" class="sala-grid"></div>

        <label>2. Escolha o Equipamento:</label>
        <select id="res-item" onchange="checkChrome()">
            <option value="TV Digital (Pat: 230180)">TV Digital (Pat: 230180)</option>
            <option value="Carrinho Chromebook (Pat: 247880)">Carrinho Chromebook (Pat: 247880)</option>
            <option value="Lab. Inform√°tica">Laborat√≥rio de Inform√°tica</option>
        </select>

        <div id="chrome-box" class="form-group hidden" style="margin-top: 15px;">
            <label>Quantidade de Chromebooks:</label>
            <input type="number" id="res-qtd" min="1" max="40" value="1">
        </div>

        <div style="display: flex; gap: 10px; margin-top: 15px;">
            <div class="form-group" style="flex: 1;">
                <label>Data e Hora In√≠cio:</label>
                <input type="datetime-local" id="res-data-ini">
            </div>
            <div class="form-group" style="flex: 1;">
                <label>Previs√£o de Entrega:</label>
                <input type="datetime-local" id="res-data-fim">
            </div>
        </div>

        <button class="btn" onclick="validarReserva()">Confirmar e Protocolar</button>
        <button class="btn" style="background:#777; margin-top:10px;" onclick="show('scr-menu')">Voltar</button>
    </div>

    <div id="scr-timer" class="panel hidden" style="text-align: center;">
        <h2>Reserva Ativa</h2>
        <div id="timer-display">00:00:00</div>
        <p id="timer-msg" style="font-size: 18px; color: #555;"></p>
        <button class="btn" style="background: #28a745;" onclick="liberarEquipamento()">FINALIZAR USO / LIBERAR ITEM</button>
    </div>

    <div id="scr-suporte" class="panel hidden">
        <h2>Chamado T√©cnico</h2>
        <label>Gravidade:</label>
        <select id="sup-cor" style="font-weight: bold; margin-bottom: 15px;">
            <option value="verde" style="color: green;">üü¢ VERDE (Pode esperar)</option>
            <option value="amarelo" style="color: orange;">üü° AMARELO (Urgente)</option>
            <option value="vermelho" style="color: red;">üî¥ VERMELHO (IMEDIATO)</option>
        </select>
        <textarea id="sup-txt" rows="5" placeholder="Descreva o problema..."></textarea>
        <button class="btn" style="background: #d9534f; margin-top: 15px;" onclick="alert('Enviado!'); show('scr-menu')">Enviar para TI</button>
        <button class="btn" style="background:#777; margin-top:10px;" onclick="show('scr-menu')">Voltar</button>
    </div>

</div>

<script>
    let salaAtiva = "";
    let itemEmUso = ""; // Simula√ß√£o de "banco de dados" para bloquear itens
    let profGlobal = {};
    let tInterval;

    function show(id) {
        document.querySelectorAll('.panel, #scr-menu').forEach(p => p.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    function salvarPerfil() {
        profGlobal.nome = document.getElementById('prof-nome').value;
        if(!profGlobal.nome) return alert("Preencha seu nome!");
        document.getElementById('user-display').innerText = "Prof: " + profGlobal.nome;
        show('scr-menu');
    }

    function initSalas() {
        const grid = document.getElementById('grid-salas');
        for(let i=1; i<=9; i++) {
            let b = document.createElement('button');
            b.className = 'sala-btn';
            b.innerText = i + "¬∫ ANO A";
            b.onclick = () => {
                grid.querySelectorAll('.sala-btn').forEach(x => x.classList.remove('active'));
                b.classList.add('active');
                salaAtiva = b.innerText;
            };
            grid.appendChild(b);
        }
    }

    function checkChrome() {
        const val = document.getElementById('res-item').value;
        document.getElementById('chrome-box').classList.toggle('hidden', !val.includes("Chromebook"));
    }

    function validarReserva() {
        const item = document.getElementById('res-item').value;
        const fim = document.getElementById('res-data-fim').value;

        // Regra de Notifica√ß√£o: Se o item j√° estiver reservado
        if(itemEmUso === item) {
            alert("‚ö†Ô∏è NOTIFICA√á√ÉO: O item [" + item + "] j√° se encontra RESERVADO ou EM USO por outro professor no momento!");
            return;
        }

        if(!salaAtiva || !fim) return alert("Preencha todos os dados!");

        itemEmUso = item; // Bloqueia o item
        show('scr-timer');
        document.getElementById('timer-msg').innerText = "Item: " + item + " | Sala: " + salaAtiva;
        startCountdown(fim);
    }

    function startCountdown(fim) {
        clearInterval(tInterval);
        tInterval = setInterval(() => {
            const agora = new Date().getTime();
            const target = new Date(fim).getTime();
            const dist = target - agora;

            if (dist < 0) {
                clearInterval(tInterval);
                document.getElementById('timer-display').innerText = "EXPIRADO";
                document.getElementById('timer-display').style.color = "red";
                alert("O tempo acabou! Devolva o equipamento para liberar ao pr√≥ximo.");
            } else {
                let h = Math.floor(dist / (1000 * 60 * 60));
                let m = Math.floor((dist % (1000 * 60 * 60)) / (1000 * 60));
                let s = Math.floor((dist % (1000 * 60)) / 1000);
                document.getElementById('timer-display').innerText = 
                    `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                
                if(m === 5 && s === 0) alert("Faltam 5 minutos para o hor√°rio de entrega!");
            }
        }, 1000);
    }

    function liberarEquipamento() {
        clearInterval(tInterval);
        itemEmUso = ""; // Libera o item para a pr√≥xima pessoa
        alert("Equipamento finalizado e liberado no sistema!");
        show('scr-menu');
    }

    initSalas();
</script>

</body>
</html>
